CREATE OR REPLACE FUNCTION TZ_DATE(TIMESTAMP WITH TIME ZONE, TEXT) RETURNS DATE
    LANGUAGE PLPGSQL
    STABLE STRICT
AS
$$
BEGIN
    RETURN ($1 AT TIME ZONE $2) :: DATE;
END;
$$;